---
title: "eds221_day8_interactive_session"
format: html
editor: visual
editor_options: 
  chunk_output_type: inline
---

```{r}
library(tidyverse)
library(here)
library(janitor)

library(patchwork)
library(ggrepel)
library(gghighlight)
library(paletteer)
library(ggExtra)
library(ggbeeswarm)

library(gapminder)
library(sf)
library(paletteer)
```

# date: data collection date
# scientific name: scientific name of lizards
# common name: common name
# site: research site code
# sex: sex of lizards
# sv_length: snout-vent length in mm
# total_length: length in mm
# toe_num: toee mark number
#tail: tail condition 


```{r}
lizards <-  read_csv(here("data_tidy", "lizards.csv"))
```
```{r}
#example of a good graph that is easy to read
ggplot(data = lizards, aes(x = total_length, y = weight)) +
  geom_point()
```

```{r}
#exampel of a bad one
ggplot(data = lizards, aes(x = total_length, y = weight)) + geom_line()
```
```{r}
ggplot(data = lizards, aes(x = total_length)) +
  geom_histogram()
```

```{r}
#jitter plots use one categorical and one continuous numerical
ggplot(data = lizards, aes(y = common_name, x = weight)) + geom_jitter()
```
## Aesthetic mapping

# fill: updates fill colors (columns, density, violin and boxplot interior color)
# color: updates point & border line colors
#shape: update point style
# alpha: updates transparency
# size: point size or line width
# linetype: update the line by referring to a constant value THIS SHOULD NOT BE WITHIN THE aes()


#creating nightmare graphs



```{r}
ggplot(data = lizards, aes(x = weight)) +        geom_histogram(color = "purple",
                                                                          fill = "orange",
                                                                          size = 2,
                                                                          linetype = "dotted"
)
```
```{r}
ggplot(data = lizards, aes(x = total_length, y = weight)) +
  geom_point(color = "cyan4", 
             fill = "yellow",
             shape = 22,
             alpha = .6)
```

#Updating an aes based on a variable Yes aes()

```{r}
ggplot(data = lizards, aes(x = total_length, y = weight)) +
  geom_point(aes(color = common_name, size = total_length))
```

#the above graph can be a good combination however the points are quite big. So we can minimize them.

```{r}
ggplot(data = lizards, aes(x = total_length, y = weight)) +
  geom_point(aes(color = common_name), alpha = .3)
```

## Themes

# Themes are built in themes, we just use + theme_*()

the main ones are:
- theme_minimal()
- theme_bw()
- theme_light()

```{r}
ggplot(data = lizards, aes(x = site, y = weight)) +
  geom_jitter(aes(color = common_name)) +
  theme_minimal()
```

# Axis labels

using basics

```{r}
ggplot(data = lizards, aes(x = total_length, y = weight)) +
  geom_point(aes(color = common_name)) +
  labs(x = "Lizard Length (mm)", y = "Lizard Weight")
```

# Facetting

sometimes its useful to split up info in graph into separate graphs. Example..... to separate graph for total length vs weight for EACH LIZARD SPECIES.

Manually is tedious but we can using the faceting functions

- facet_wrap()
- facet_grid()


```{r}
#if we want a species to have its own panel, we use facet wrap()


ggplot(data = lizards, aes(x = total_length, y = weight)) +
  geom_point() +
  facet_wrap(~common_name, ncol = 3, scales = "free")
```
#What if we want to get a count?


#What if we want to make a grid where panels are split across groups by lizard sex and if it has a broken tail or not? 

We have two variables being used to create our grid, well use facet_grid()

```{r}
ggplot(data = lizards, aes(x = total_length, y = weight)) +
  geom_point() +
  facet_grid(sex ~ tail)
```

# Getting things in order
- GG plot likes to arder things alphabetically. But sometimes we want it thigns differently if we have categorically.

- Lets find some total counts of lizards in the dataset by commin name, then make a column graph

```{r}
lizard_count <- lizards %>% 
  count(common_name)

ggplot(data = lizard_count, aes(y = fct_reorder(common_name, n), x = n)) +
  geom_col()
```


## Advanced GG plot customizations


```{r}
ggplot(data = lizards, aes(x = total_length, y = weight)) +
  geom_point() + 
  scale_x_continuous(breaks = c(0, 250, 500),
                     limits = c(0, 500)) +
  scale_y_continuous(breaks = seq(from = 0, 
                                  to = 70,
                                  by = 10),
                     limits = c(0,70)) + 
  labs( x = "Total Length", 
        y = "Weight (grams)") +
  theme_minimal()
```

```{r}
#counting up the number of lizards per day
lizard_counts <- lizards %>%
  mutate(date = lubridate::mdy(date)) %>% 
  count(date)
```
```{r}
ggplot(data = lizard_counts,
       aes(x = date, y = n)) +
  geom_line() +
  scale_x_date(breaks = scales::breaks_width("2 Years"),
               labels = scales::label_date("%Y"))
```

### Customization of aes with 'scale()'

```{r}
# color gradient with two colors
ggplot(data = lizards,
       aes(x = total_length,
           y = weight)) +
  geom_point(aes(color = weight)) +
  scale_color_gradient(low = "red", high = "navy")

#color gradient with more than 2 colors.......
p2 <- ggplot(data = lizards,
       aes(x = total_length,
           y = weight)) +
  geom_point(aes(color = weight)) +
  #the function below is scalle_color_grandientn not the one above
  scale_color_gradientn(colors = c("orange", "red", "purple", "navy", "black"))


# now create a gradient of color bins

```
```{r}
p1 <- ggplot(data = lizards,
       aes(x = total_length, y = weight)) +
  geom_point(aes(color = weight)) +
  scale_color_steps(low = "red", high = "blue",
                    breaks = seq(0, 80, by = 5))
```



```{r}
ggplot(data = lizards,
       aes(x = common_name, y = total_length)) +
  geom_boxplot(aes(fill = common_name),
              show.legend = FALSE) +
  coord_flip()



```
```{r}
#find the median values
```


```{r}
#ordering the species based on median length
lizards_mean <- lizards %>%
  mutate(common_name = fct_reorder(common_name, 
                                   total_length,
                                   .fun = median))

p1 <- ggplot(data = lizards_mean,
       aes(y = common_name, x = total_length)) +
  geom_boxplot(aes(fill = common_name), show_legend = FALSE) +
  scale_fill_paletteer_d("MoMAColors::Abott") +
  labs(x = "Total Length (mm)", 
       y = "Species") +
  theme_minimal() +
  theme(panel.grid.minor = element_blank())
  
```

#Working with patchwork

```{r}
#vertical bar plots next to each other
library(patchwork)

(p1 | p2) & theme_minimal()

#the / will put them on top of each other
# so for example

(p1/p2/p1/p2) & theme_minimal()

#combinations of next to and on top

p3 <- ((p1 | p2)/ p2) & theme_minimal()

ggsave("test.png", p3)
```











